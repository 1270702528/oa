
<div class="easyui-layout" data-options="fit:true">
    <div data-options="region:'center',border:false">
    	<!-- Begin of toolbar -->
        <div id="project-wu-toolbar">
            <div class="wu-toolbar-button">
                <a href="javascript:projectopenAdd();" class="easyui-linkbutton" iconCls="icon-add"  plain="true">添加</a>
                <a href="javascript:projectopenEdit();" class="easyui-linkbutton" iconCls="icon-edit"  plain="true">修改</a>
            </div>
           
        </div>
        <!-- End of toolbar -->
        <div style="height: 420px;">
       	    <table id="project-wu-datagrid"></table>
        </div>
        
      
    </div>
</div>
<!-- Begin of easyui-dialog -->
<div id="project-wu-dialog" class="easyui-dialog" data-options="closed:true,iconCls:'icon-save'" style="height:400px;;width:400px; padding:10px;">
	<form id="project-wu-form" method="post">
        <table>
            <tr>
                <td width="60" align="right">标题:</td>
                <td><input type="text" name="title" class="wu-text" style="width: 250px;" /></td>
            </tr>
            <!--  
            <tr>
                <td align="right">描述:</td>
                <td><textarea   name="description"  style="width: 250px;height: 80px;"></textarea></td>
            </tr>
 			
 			 -->
 			
 			<tr>
                <td align="right">企业名称:</td>
                <td><input type="text"  name="F01" class="wu-text" style="width: 250px;"></td>
            </tr>
           
            <tr>
                <td align="right">成立日期:</td>
                <td><input type="text"  name="F02" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">注册资本:</td>
                <td><input type="text"  name="F03" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">实收资本:</td>
                <td><input type="text"  name="F04" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">注册号/信用代码:</td>
                <td><input type="text"  name="F05" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">开户许可证:</td>
                <td><input type="text"  name="F06" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">现经营地址:</td>
                <td><input type="text"  name="F07" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">企业性质:</td>
                <td><input type="text"  name="F08" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">法定代表人:</td>
                <td><input type="text"  name="F09" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">实际控制人及联系方式:</td>
                <td><input type="text"  name="F10" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">账户名:</td>
                <td><input type="text"  name="F11" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">账  号:</td>
                <td><input type="text"  name="F12" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">开户行:</td>
                <td><input type="text"  name="F13" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">从业人数:</td>
                <td><input type="text"  name="F14" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">管理人员人数:</td>
                <td><input type="text"  name="F15" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">普通员工人数:</td>
                <td><input type="text"  name="F16" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">股东情况:</td>
                <td><textarea   name="F17"  style="width: 250px;height: 80px;"></textarea></td>
            </tr>
            <tr>
                <td align="right">财务情况:</td>
                <td><input type="text"  name="F18" class="wu-text" style="width: 250px;"></td>
            </tr>
            <!-- 
            <tr>
                <td align="right">资产明细:</td>
                <td><input type="text"  name="F19" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">负债明细:</td>
                <td><input type="text"  name="F20" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">借款金额:</td>
                <td><input type="text"  name="F21" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">借款期限:</td>
                <td><input type="text"  name="F22" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">借款年化利率:</td>
                <td><input type="text"  name="F23" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">居间服务年化利率:</td>
                <td><input type="text"  name="F24" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">还款方式:</td>
                <td><input type="text"  name="F25" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">担保方式:</td>
                <td><input type="text"  name="F26" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">借款用途:</td>
                <td><input type="text"  name="F27" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">还款来源:</td>
                <td><input type="text"  name="F28" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">保证人姓名:</td>
                <td><input type="text"  name="F29" class="wu-text" style="width: 250px;"></td>
            </tr>
            <tr>
                <td align="right">保证人身份证号:</td>
                <td><input type="text"  name="F30" class="wu-text" style="width: 250px;"></td>
            </tr>
              <tr>
                <td align="right">保证人联系电话:</td>
                <td><input type="text"  name="F31" class="wu-text" style="width: 250px;"></td>
            </tr>
           
            <tr>
                <td align="right">在其他网贷平台借款情况:</td>
                <td><input type="text"  name="F33" class="wu-text" style="width: 250px;"></td>
            </tr>
             -->
              <tr>
                <td align="right">保证人信息:</td>
                <td><textarea   name="F32"  style="width: 250px;height: 80px;"></textarea></td>
            </tr>
        </table>
    </form>
</div>
<!-- End of easyui-dialog -->
<script type="text/javascript">

	

	/**
		检查字段
	**/
	function projectcheck(type){
		
		var name=$("#project-wu-form input[name='title']").val();
		
		var message=$("#project-wu-form textarea[name='description']").val();

		if(name==''){
			$.messager.alert('信息提示','标题不能为空！','warning');
			return false;
		}
		
		if(message==''){
			$.messager.alert('信息提示','描述不能为空！','warning');
			return false;
		}

		
		return true;
	}
	/**
	* Name 添加记录
	*/
	function projectadd(){
		if(projectcheck()){
			$('#project-wu-form').form('submit', {
				url:'project/create',
				success:function(data){
					$.messager.show({title:"提示信息",msg:"添加成功"});	
					$('#project-wu-dialog').dialog('close');
					$('#project-wu-datagrid').datagrid("reload");
				}
			});
		}
	}
	

	
	
	/**
	* Name 打开添加窗口
	*/
	function projectopenAdd(){
		$('#project-wu-form').form('clear');
		$('#project-wu-dialog').dialog({
			closed: false,
			modal:true,
            title: "添加信息",
            buttons: [{
                text: '确定',
                iconCls: 'icon-ok',
                handler: projectadd
            }, {
                text: '取消',
                iconCls: 'icon-cancel',
                handler: function () {
                    $('#project-wu-dialog').dialog('close');                    
                }
            }]
        });
	}
	
	/**
	* Name 打开修改窗口
	*/
	function projectopenEdit(){
		$('#project-wu-form').form('clear');
		var item = $('#project-wu-datagrid').datagrid('getSelected');
		$("#project-wu-form input[name='title']").val(item.title);
		$("#project-wu-form textarea[name='description']").val(item.description);
		$("#project-wu-form input[name='F01']").val(item.f01);
		$("#project-wu-form input[name='F02']").val(item.f02);
		$("#project-wu-form input[name='F03']").val(item.f03);
		$("#project-wu-form input[name='F04']").val(item.f04);
		$("#project-wu-form input[name='F05']").val(item.f05);
		$("#project-wu-form input[name='F06']").val(item.f06);
		$("#project-wu-form input[name='F07']").val(item.f07);
		$("#project-wu-form input[name='F08']").val(item.f08);
		$("#project-wu-form input[name='F09']").val(item.f09);
		$("#project-wu-form input[name='F10']").val(item.f10);
		$("#project-wu-form input[name='F11']").val(item.f11);
		$("#project-wu-form input[name='F12']").val(item.f12);
		$("#project-wu-form input[name='F13']").val(item.f13);
		$("#project-wu-form input[name='F14']").val(item.f14);
		$("#project-wu-form input[name='F15']").val(item.f15);
		$("#project-wu-form input[name='F16']").val(item.f16);
		$("#project-wu-form textarea[name='F17']").val(item.f17);
		$("#project-wu-form input[name='F18']").val(item.f18);
		$("#project-wu-form input[name='F19']").val(item.f19);
		$("#project-wu-form input[name='F20']").val(item.f20);
		$("#project-wu-form input[name='F21']").val(item.f21);
		$("#project-wu-form input[name='F22']").val(item.f22);
		$("#project-wu-form input[name='F23']").val(item.f23);
		$("#project-wu-form input[name='F24']").val(item.f24);
		$("#project-wu-form input[name='F25']").val(item.f25);
		$("#project-wu-form input[name='F26']").val(item.f26);
		$("#project-wu-form input[name='F27']").val(item.f27);
		$("#project-wu-form input[name='F28']").val(item.f28);
		$("#project-wu-form input[name='F29']").val(item.f29);
		$("#project-wu-form input[name='F30']").val(item.f30);
		$("#project-wu-form input[name='F31']").val(item.f31);
		$("#project-wu-form textarea[name='F32']").val(item.f32);
		$("#project-wu-form input[name='F33']").val(item.f33);


		$('#project-wu-dialog').dialog({
			closed: false,
			modal:true,
            title: "修改信息",
            buttons: [{
                text: '确定',
                iconCls: 'icon-ok',
                handler: function (){
            		if(projectcheck()){
            			$('#project-wu-form').form('submit', {
            				url:'project/update?id='+item.id,
            				success:function(data){
            					$.messager.show({title:"提示信息",msg:"修改成功"});	
            					$('#project-wu-dialog').dialog('close');
            					$('#project-wu-datagrid').datagrid("reload");	
            				}
            			});
            		}
            	}
            }, {
                text: '取消',
                iconCls: 'icon-cancel',
                handler: function () {
                    $('#project-wu-dialog').dialog('close');                    
                }
            }]
        });
	}	

	/*
	var p = $('#project-wu-datagrid').datagrid('getPager');  
	$(p).pagination({  
	    beforePageText: '第',
	    afterPageText: '页    共 {pages} 页',  
	    displayMsg: '第{from}到{to}条，共{total}条',  
	});  */
	
	$('#project-wu-datagrid').datagrid({ loadFilter: pagerFilter }).datagrid({
		url:'project/list',	
		method:'GET',	
		singleSelect:true,        
		pagination:true,
		fitColumns:true,
		fit:true,
		columns:[[
			{ checkbox:true},
			{ field:'title',title:'标题',width:100},
			{ field:'userName',title:'办理人',width:50},
			{ field:'taskName',title:'任务',width:50},
			{ field:'createTime',title:'申请时间',width:100},
			{ field:'status',title:'状态',width:100,
				formatter:function(value){
			
					if(value==0){
						return "初始录入";
					}else if(value==1){
						return "审核中";
					}else if(value==2){
						return "审核不通过";
					}else if(value==3){
						return "审核通过";
					}else if(value==4){
						return "流标";
					}
				
			}},
			{ field:'oper',title:'操作',width:150,
				formatter:function(value,row,index){
				
					var link="";
					if(row.status==0){
						link+='<a href="javascript:apply('+row.id+');">提交申请</a> &nbsp;&nbsp;&nbsp;';
					}
					link+='<a href="javascript:viewHistory('+row.id+');">查看审核记录</a> &nbsp;&nbsp;&nbsp;';
					link+='<a href="javascript:viewAttachment('+row.id+');">查看附件</a> &nbsp;&nbsp;&nbsp;';
					link+='<a href="javascript:viewDocument('+row.id+');">资料归档</a> &nbsp;&nbsp;&nbsp;';
					return link;	
				}
			}

		]]
	});
	function viewHistory(id){
		 $("#viewHistoryVal").val(id);
		 addTab("审核记录","business/layout-2.html","icon-chart-organisation",false);  
	}
	function apply(id){
		$.post("process/start",{"id":id},function(){
			$.messager.show({title:"提示信息",msg:"操作成功"});	
			$('#project-wu-datagrid').datagrid('reload');
		})
	}
	
	function viewAttachment(id){
		 $("#viewAttachmentVal").val(id);
		 addTab("查看附件","business/layout-4.html","icon-chart-organisation",false);  
	}
	
	function viewDocument(id){
		 $("#viewDocument").val(id);
		 addTab("资料归档","business/layout-5.html","icon-chart-organisation",false);  
	}
</script>